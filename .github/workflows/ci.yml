name: CI

on: 
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@main

      - name: Configure Git User
        run: |
          git config --global user.name "Auto Commit"
          git config --global user.email "auto-commit@github.com"

      - name: Modify commit.sh && Run Shell Script Tests
        run: |
          set -e  # Stop script on any error
          url="github.com"       # Your Hostname
          username="pheiduck"        # Your GitHub username
          reponame="auto-commit"         # Your repository name

          # Modify the commit.sh file (append content)
          echo "$url" && echo "$username" && echo "$reponame" >> ./commit.sh

          # Stage the changes
          git add commit.sh
          
          # Commit the changes locally
          git commit -m "Auto-update commit.sh in CI" || true
          
          # NOTE: No git push is performed, changes remain local to this workflow
          
          sudo ./commit.sh  # Test the modified commit.sh file
